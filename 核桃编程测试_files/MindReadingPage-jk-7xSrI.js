import{_ as N,a as w,B as L,V as z,b as F,c as D,d as H,e as q,f as G}from"./bgm-DZQdjLCL.js";import{u as O,P as y,p as U,s as j}from"./ide-DTDsbgwg.js";import{A as C,S as $}from"./c2-DUC6EY5-.js";import{V as J}from"./8-ybDrEpjd.js";import{b as K,s as Q,r as W,p as M,w as T,v as X,z as Y,h as Z,o as l,y as _,e as i,u as f,i as e,g as p,E as r,A as g,F as h,q as tt,t as st,G as et,D as nt}from"./bundle-D_IRscbe.js";import"./webfontloader-DUrqEKWl.js";const ot={key:0,class:"preload"},lt={key:1,class:"panel",ref:"panelRef"},it={key:0,class:"step step-0"},rt={key:1,class:"step step-1"},ut={key:2,class:"step step-2"},at={key:0,class:"tips"},pt={key:0,class:"tips"},dt={key:5,class:"step step-5"},mt={key:6,class:"step step-6"},ct={class:"item"},ft=["src"],gt={class:"scroll-bar"},vt={key:7,class:"step step-result"},bt={key:8,class:"step step-result"},kt={class:"result-icon"},xt=["src"],Vt=K({__name:"MindReadingPage",setup(yt){const A=String(Q().query.final)=="1",d=W(null),P={1:G,2:q,3:H,4:D,5:F,7:z,8:J},s=M({step:0,tips:!1,timeout:3,resultIndex:0,icons:Array.from({length:99},(n,t)=>({index:t+1,icon:t})),closeTip:!1,scrollTop:0}),u=M({icon:[],mode:0,icon9:0,restartBtn:"0"}),{store:m,type:v,operationStart:V,operationEnd:B,operationClose:I}=O("1",n=>{v==y.SHARE&&b(n)});T(()=>m.event,n=>{if(v!=y.SHARE){if(n.cmd=="onClickClose"){$.Msg.post({cmd:"onCloseAndPassed"}),I();return}n.cmd=="mind-reading"&&(n.content.icon=String(n.content.icon).split(",").filter((t,a,o)=>t.length>0&&o.indexOf(t)==a),b(n.content),V(),j("c2-mind-reading",u,t=>{}))}});const b=n=>{u.icon=n.icon,u.mode=Number(n.mode)||0,u.icon9=Number(n.icon9)||0,u.restartBtn=n.restartBtn,U(["AliFont"],()=>{m.pageLoaded(),m.page.bgmAudio.src=L,m.page.bgmAudio.volume=.1})},E=()=>{u.icon.length<2&&(s.resultIndex=0);const n=u.icon.filter(a=>Number(a)!=s.resultIndex);s.resultIndex=Number(n[Math.floor(Math.random()*n.length)]);let t=s.resultIndex;s.icons.forEach(a=>{if(u.icon9>0&&a.index==9){a.icon=u.icon9;return}if(u.icon9==0&&a.index%9==0&&a.index<82)a.icon=s.resultIndex;else{const o=Array.from({length:10},(c,S)=>S+1).filter(c=>c!==t&&c!==s.resultIndex&&c!=u.icon9);a.icon=o[Math.floor(Math.random()*o.length)]}t=a.icon})},k=n=>{s.step=n,s.tips=!1},R=()=>{s.step=7,s.timeout=3;const n=setInterval(()=>{s.timeout--,s.timeout==0&&(s.step=8,clearInterval(n))},1e3)};X(()=>{});const x=()=>{if(d.value){const n=d.value.getBoundingClientRect();s.scrollTop=d.value.scrollTop/(d.value.scrollHeight-n.height)}};return T(()=>s.step,n=>{d.value&&d.value.removeEventListener("scroll",x),n==1&&m.page.bgmAudio.play(),[1,2,3,4,5,7,8].includes(n)&&(m.page.actAudio.src=P[n],m.page.actAudio.play()),n==6&&(E(),nt(()=>{d.value.addEventListener("scroll",x)})),n==8&&(s.closeTip=!0,A&&$.Track.trackForExp("cpp_h5_c2_1_end",{}),B()),u.mode==0&&n==6&&(s.closeTip=!0)}),(n,t)=>{const a=Y("page");return l(),Z(a,{class:"mind-reading-page",closeTip:s.closeTip,logs:n.logs},{default:_(()=>[f(m).page.loading?(l(),i("div",ot,[...t[12]||(t[12]=[e("img",{src:N},null,-1),e("img",{src:w},null,-1)])])):(l(),i("div",lt,[s.step==0?(l(),i("div",it,[t[13]||(t[13]=e("span",{class:"title"},null,-1)),e("button",{class:"btn-next",onClick:t[0]||(t[0]=o=>s.step=1)},"开始")])):p("",!0),s.step==1?(l(),i("div",rt,[t[14]||(t[14]=e("span",null,"欢迎来到我的世界",-1)),e("button",{class:"btn-next",onClick:t[1]||(t[1]=o=>s.step=2)},"继续")])):p("",!0),s.step==2?(l(),i("div",ut,[t[15]||(t[15]=e("span",null,[r("从"),e("b",null,"10-99"),r("之间任选一个数，"),e("br"),r("默默记在心中!")],-1)),e("button",{class:"btn-next",onClick:t[2]||(t[2]=o=>s.step=3)},"继续")])):p("",!0),s.step==3?(l(),i("div",{key:3,class:g(["step step-3",{"show-tips":s.tips}])},[e("span",null,[t[16]||(t[16]=r("把你心中的两位数, ",-1)),t[17]||(t[17]=e("br",null,null,-1)),t[18]||(t[18]=e("b",null,"减去个位",-1)),t[19]||(t[19]=r("的数字",-1)),e("em",{onClick:t[3]||(t[3]=o=>s.tips=!0)},"怎么算？")]),e("button",{class:"btn-next",onClick:t[4]||(t[4]=o=>k(4))},"继续"),s.tips?(l(),i("div",at,[t[20]||(t[20]=e("label",null,[r("例如：如果你选的是 25，"),e("br"),r("那就用 2"),e("b",null,"5"),r("-"),e("b",null,"5"),r("=20")],-1)),e("button",{class:"btn-next",onClick:t[5]||(t[5]=o=>s.tips=!1)},"明白了")])):p("",!0)],2)):p("",!0),s.step==4?(l(),i("div",{key:4,class:g(["step step-4",{"show-tips":s.tips}])},[e("span",null,[t[21]||(t[21]=r("再",-1)),t[22]||(t[22]=e("b",null,"减去十位的数字，",-1)),t[23]||(t[23]=e("br",null,null,-1)),t[24]||(t[24]=r("记住这个结果数字！",-1)),e("em",{onClick:t[6]||(t[6]=o=>s.tips=!0)},"怎么算？")]),e("button",{class:"btn-next",onClick:t[7]||(t[7]=o=>k(5))},"继续"),s.tips?(l(),i("div",pt,[t[25]||(t[25]=e("label",null,[r("例如：再用刚才的结果"),e("br"),e("b",null,"2"),r("0-"),e("b",null,"2"),r("=18，"),e("i",null,"18 就是结果数字")],-1)),e("button",{class:"btn-next",onClick:t[8]||(t[8]=o=>s.tips=!1)},"明白了")])):p("",!0)],2)):p("",!0),s.step==5?(l(),i("div",dt,[t[26]||(t[26]=e("span",null,[r("找到结果"),e("i",null,"数字对应的图案，"),e("br"),r("牢记在心中！")],-1)),e("button",{class:"btn-next",onClick:t[9]||(t[9]=o=>s.step=6)},"继续")])):p("",!0),s.step==6?(l(),i("div",mt,[e("div",{class:"items",ref_key:"itemsRef",ref:d},[(l(!0),i(h,null,tt(s.icons,o=>(l(),i("div",ct,[e("label",null,st(o.index<10?"0"+o.index:o.index),1),e("img",{src:"".concat(f(C)("mind-reading/".concat(o.icon,".png")))},null,8,ft)]))),256))],512),e("div",gt,[e("em",{style:et({marginTop:"calc(var(--size-1) * 26 * ".concat(s.scrollTop,")")})},null,4)]),u.mode==1?(l(),i("button",{key:0,class:"btn-next",onClick:t[10]||(t[10]=o=>R())},"记住了")):p("",!0)])):p("",!0),s.step==7?(l(),i("div",vt,[t[27]||(t[27]=e("div",{class:"title"},"注视水晶球",-1)),e("div",{class:g(["timeout","timeout-".concat(s.timeout)])},null,2)])):p("",!0),s.step==8?(l(),i("div",bt,[t[28]||(t[28]=e("div",{class:"title"},"你心中所想的是",-1)),e("div",kt,[e("img",{src:"".concat(f(C)("mind-reading/".concat(s.resultIndex,".png")))},null,8,xt)]),u.restartBtn=="1"?(l(),i("button",{key:0,class:"btn-next",onClick:t[11]||(t[11]=o=>s.step=0)},"再试一次")):p("",!0)])):p("",!0)],512))]),_:1},8,["closeTip","logs"])}}});export{Vt as default};
